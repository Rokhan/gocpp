// generated by GoCpp from file '$(ImportDir)/compress/flate/deflate.go'
#pragma once

#include <functional>
#include <string>
#include <tuple>
#include <vector>

#include "golang/compress/flate/deflate.fwd.h"
#include "gocpp/support.h"

#include "golang/compress/flate/deflatefast.h"
#include "golang/compress/flate/huffman_bit_writer.h"
#include "golang/compress/flate/huffman_code.h"
#include "golang/compress/flate/token.h"
#include "golang/io/io.h"

namespace golang::flate
{
    struct compressionLevel
    {
        int level;
        int good;
        int lazy;
        int nice;
        int chain;
        int fastSkipHashing;

        using isGoStruct = void;

        template<typename T> requires gocpp::GoStruct<T>
        operator T();

        template<typename T> requires gocpp::GoStruct<T>
        bool operator==(const T& ref) const;

        std::ostream& PrintTo(std::ostream& os) const;
    };

    std::ostream& operator<<(std::ostream& os, const struct compressionLevel& value);
    uint32_t hash4(gocpp::slice<unsigned char> b);
    void bulkHash4(gocpp::slice<unsigned char> b, gocpp::slice<uint32_t> dst);
    int matchLen(gocpp::slice<unsigned char> a, gocpp::slice<unsigned char> b, int max);
    std::tuple<struct Writer*, struct gocpp::error> NewWriter(io::Writer w, int level);
    std::tuple<struct Writer*, struct gocpp::error> NewWriterDict(io::Writer w, int level, gocpp::slice<unsigned char> dict);
    struct dictWriter
    {
        io::Writer w;

        using isGoStruct = void;

        template<typename T> requires gocpp::GoStruct<T>
        operator T();

        template<typename T> requires gocpp::GoStruct<T>
        bool operator==(const T& ref) const;

        std::ostream& PrintTo(std::ostream& os) const;
    };

    std::ostream& operator<<(std::ostream& os, const struct dictWriter& value);
    extern gocpp::error errWriterClosed;
    extern gocpp::slice<compressionLevel> levels;
    struct compressor
    {
        compressionLevel compressionLevel;
        huffmanBitWriter* w;
        std::function<void (gocpp::slice<unsigned char> _1, gocpp::slice<uint32_t> _2)> bulkHasher;
        std::function<int (struct compressor* _1, gocpp::slice<unsigned char> _2)> fill;
        std::function<void (struct compressor* _1)> step;
        bool sync;
        deflateFast* bestSpeed;
        int chainHead;
        gocpp::array<uint32_t, hashSize> hashHead;
        gocpp::array<uint32_t, windowSize> hashPrev;
        int hashOffset;
        int index;
        gocpp::slice<unsigned char> window;
        int windowEnd;
        int blockStart;
        bool byteAvailable;
        gocpp::slice<golang::flate::token> tokens;
        int length;
        int offset;
        int maxInsertIndex;
        gocpp::error err;
        gocpp::array<uint32_t, maxMatchLength - 1> hashMatch;

        using isGoStruct = void;

        template<typename T> requires gocpp::GoStruct<T>
        operator T();

        template<typename T> requires gocpp::GoStruct<T>
        bool operator==(const T& ref) const;

        std::ostream& PrintTo(std::ostream& os) const;
    };

    std::ostream& operator<<(std::ostream& os, const struct compressor& value);
    struct Writer
    {
        compressor d;
        gocpp::slice<unsigned char> dict;

        using isGoStruct = void;

        template<typename T> requires gocpp::GoStruct<T>
        operator T();

        template<typename T> requires gocpp::GoStruct<T>
        bool operator==(const T& ref) const;

        std::ostream& PrintTo(std::ostream& os) const;
    };

    std::ostream& operator<<(std::ostream& os, const struct Writer& value);

    namespace rec
    {
        int fillDeflate(golang::flate::compressor* d, gocpp::slice<unsigned char> b);
        struct gocpp::error writeBlock(golang::flate::compressor* d, gocpp::slice<golang::flate::token> tokens, int index);
        void fillWindow(golang::flate::compressor* d, gocpp::slice<unsigned char> b);
        std::tuple<int, int, bool> findMatch(golang::flate::compressor* d, int pos, int prevHead, int prevLength, int lookahead);
        struct gocpp::error writeStoredBlock(golang::flate::compressor* d, gocpp::slice<unsigned char> buf);
        void encSpeed(golang::flate::compressor* d);
        void initDeflate(golang::flate::compressor* d);
        void deflate(golang::flate::compressor* d);
        int fillStore(golang::flate::compressor* d, gocpp::slice<unsigned char> b);
        void store(golang::flate::compressor* d);
        void storeHuff(golang::flate::compressor* d);
        std::tuple<int, struct gocpp::error> write(golang::flate::compressor* d, gocpp::slice<unsigned char> b);
        struct gocpp::error syncFlush(golang::flate::compressor* d);
        struct gocpp::error init(golang::flate::compressor* d, io::Writer w, int level);
        void reset(golang::flate::compressor* d, io::Writer w);
        struct gocpp::error close(golang::flate::compressor* d);
        std::tuple<int, struct gocpp::error> Write(golang::flate::dictWriter* w, gocpp::slice<unsigned char> b);
        std::tuple<int, struct gocpp::error> Write(golang::flate::Writer* w, gocpp::slice<unsigned char> data);
        struct gocpp::error Flush(golang::flate::Writer* w);
        struct gocpp::error Close(golang::flate::Writer* w);
        void Reset(golang::flate::Writer* w, io::Writer dst);
    }
}

