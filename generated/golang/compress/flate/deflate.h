// generated by GoCpp from file '$(ImportDir)/compress/flate/deflate.go'
#pragma once

#include <functional>
#include <string>
#include <tuple>
#include <vector>

#include "golang/compress/flate/deflate.fwd.h"
#include "gocpp/support.h"

#include "golang/compress/flate/deflatefast.h"
#include "golang/compress/flate/huffman_bit_writer.h"
#include "golang/compress/flate/token.h"
#include "golang/errors/errors.h"
#include "golang/fmt/errors.h"
// #include "golang/io/io.h"  [Ignored, known errors]
#include "golang/math/const.h"

namespace golang::flate
{
    extern int NoCompression;
    extern int BestSpeed;
    extern int BestCompression;
    extern int DefaultCompression;
    extern int HuffmanOnly;
    extern int logWindowSize;
    extern int windowSize;
    extern int windowMask;
    extern int baseMatchLength;
    extern int minMatchLength;
    extern int maxMatchLength;
    extern int baseMatchOffset;
    extern int maxMatchOffset;
    extern int maxFlateBlockTokens;
    extern int maxStoreBlockSize;
    extern int hashBits;
    extern int hashSize;
    extern int hashMask;
    extern int maxHashOffset;
    extern int skipNever;
    struct compressionLevel
    {
        int level;
        int good;
        int lazy;
        int nice;
        int chain;
        int fastSkipHashing;

        using isGoStruct = void;

        std::ostream& PrintTo(std::ostream& os) const;
    };

    std::ostream& operator<<(std::ostream& os, const struct compressionLevel& value);
    extern gocpp::slice<compressionLevel> levels;
    struct compressor
    {
        huffmanBitWriter* w;
        std::function<void (gocpp::slice<unsigned char>, gocpp::slice<uint32_t>)> bulkHasher;
        std::function<int (compressor*, gocpp::slice<unsigned char>)> fill;
        std::function<void (compressor*)> step;
        bool sync;
        deflateFast* bestSpeed;
        int chainHead;
        gocpp::array<uint32_t, hashSize> hashHead;
        gocpp::array<uint32_t, windowSize> hashPrev;
        int hashOffset;
        int index;
        gocpp::slice<unsigned char> window;
        int windowEnd;
        int blockStart;
        bool byteAvailable;
        gocpp::slice<token> tokens;
        int length;
        int offset;
        int maxInsertIndex;
        std::string err;
        gocpp::array<uint32_t, maxMatchLength - 1> hashMatch;

        using isGoStruct = void;

        std::ostream& PrintTo(std::ostream& os) const;
    };

    std::ostream& operator<<(std::ostream& os, const struct compressor& value);
    int fillDeflate(struct compressor* d, gocpp::slice<unsigned char> b);
    std::string writeBlock(struct compressor* d, gocpp::slice<token> tokens, int index);
    void fillWindow(struct compressor* d, gocpp::slice<unsigned char> b);
    std::tuple<int, int, bool> findMatch(struct compressor* d, int pos, int prevHead, int prevLength, int lookahead);
    std::string writeStoredBlock(struct compressor* d, gocpp::slice<unsigned char> buf);
    extern int hashmul;
    uint32_t hash4(gocpp::slice<unsigned char> b);
    void bulkHash4(gocpp::slice<unsigned char> b, gocpp::slice<uint32_t> dst);
    int matchLen(gocpp::slice<unsigned char> a, gocpp::slice<unsigned char> b, int max);
    void encSpeed(struct compressor* d);
    void initDeflate(struct compressor* d);
    void deflate(struct compressor* d);
    int fillStore(struct compressor* d, gocpp::slice<unsigned char> b);
    void store(struct compressor* d);
    void storeHuff(struct compressor* d);
    std::tuple<int, std::string> write(struct compressor* d, gocpp::slice<unsigned char> b);
    std::string syncFlush(struct compressor* d);
    std::string init(struct compressor* d, io::Writer w, int level);
    void reset(struct compressor* d, io::Writer w);
    std::string close(struct compressor* d);
    std::tuple<Writer*, std::string> NewWriter(io::Writer w, int level);
    std::tuple<Writer*, std::string> NewWriterDict(io::Writer w, int level, gocpp::slice<unsigned char> dict);
    struct dictWriter
    {
        io::Writer w;

        using isGoStruct = void;

        std::ostream& PrintTo(std::ostream& os) const;
    };

    std::ostream& operator<<(std::ostream& os, const struct dictWriter& value);
    std::tuple<int, std::string> Write(struct dictWriter* w, gocpp::slice<unsigned char> b);
    extern std::string errWriterClosed;
    struct Writer
    {
        compressor d;
        gocpp::slice<unsigned char> dict;

        using isGoStruct = void;

        std::ostream& PrintTo(std::ostream& os) const;
    };

    std::ostream& operator<<(std::ostream& os, const struct Writer& value);
    std::tuple<int, std::string> Write(struct Writer* w, gocpp::slice<unsigned char> data);
    std::string Flush(struct Writer* w);
    std::string Close(struct Writer* w);
    void Reset(struct Writer* w, io::Writer dst);
}

