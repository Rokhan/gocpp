// generated by GoCpp from file '$(ImportDir)/math/bits/bits.go'
#include <complex>
#include <functional>
#include <iostream>
#include <iomanip>
#include <map>
#include <string>
#include <tuple>
#include <vector>

#include "golang/math/bits/bits.h"
#include "gocpp/support.h"

#include "golang/math/bits/bits_tables.h"

namespace golang::bits
{
    namespace rec
    {
        using namespace mocklib::rec;
        using namespace bits::rec;
    }

    int LeadingZeros(unsigned int x)
    {
        return UintSize - Len(x);
    }

    int LeadingZeros8(uint8_t x)
    {
        return 8 - Len8(x);
    }

    int LeadingZeros16(uint16_t x)
    {
        return 16 - Len16(x);
    }

    int LeadingZeros32(uint32_t x)
    {
        return 32 - Len32(x);
    }

    int LeadingZeros64(uint64_t x)
    {
        return 64 - Len64(x);
    }

    gocpp::array<unsigned char, 32> deBruijn32tab = gocpp::array<unsigned char, 32> {0, 1, 28, 2, 29, 14, 24, 3, 30, 22, 20, 15, 25, 17, 4, 8, 31, 27, 13, 23, 21, 19, 16, 7, 26, 12, 18, 6, 11, 5, 10, 9};
    gocpp::array<unsigned char, 64> deBruijn64tab = gocpp::array<unsigned char, 64> {0, 1, 56, 2, 57, 49, 28, 3, 61, 58, 42, 50, 38, 29, 17, 4, 62, 47, 59, 36, 45, 43, 51, 22, 53, 39, 33, 30, 24, 18, 12, 5, 63, 55, 48, 27, 60, 41, 37, 16, 46, 35, 44, 21, 52, 32, 23, 11, 54, 26, 40, 15, 34, 20, 31, 10, 25, 14, 19, 9, 13, 8, 7, 6};
    int TrailingZeros(unsigned int x)
    {
        if(UintSize == 32)
        {
            return TrailingZeros32(uint32_t(x));
        }
        return TrailingZeros64(uint64_t(x));
    }

    int TrailingZeros8(uint8_t x)
    {
        return int(ntz8tab[x]);
    }

    int TrailingZeros16(uint16_t x)
    {
        if(x == 0)
        {
            return 16;
        }
        return int(deBruijn32tab[uint32_t(x & - x) * deBruijn32 >> (32 - 5)]);
    }

    int TrailingZeros32(uint32_t x)
    {
        if(x == 0)
        {
            return 32;
        }
        return int(deBruijn32tab[(x & - x) * deBruijn32 >> (32 - 5)]);
    }

    int TrailingZeros64(uint64_t x)
    {
        if(x == 0)
        {
            return 64;
        }
        return int(deBruijn64tab[(x & - x) * deBruijn64 >> (64 - 6)]);
    }

    int OnesCount(unsigned int x)
    {
        if(UintSize == 32)
        {
            return OnesCount32(uint32_t(x));
        }
        return OnesCount64(uint64_t(x));
    }

    int OnesCount8(uint8_t x)
    {
        return int(pop8tab[x]);
    }

    int OnesCount16(uint16_t x)
    {
        return int(pop8tab[x >> 8] + pop8tab[x & 0xff]);
    }

    int OnesCount32(uint32_t x)
    {
        return int(pop8tab[x >> 24] + pop8tab[(x >> 16) & 0xff] + pop8tab[(x >> 8) & 0xff] + pop8tab[x & 0xff]);
    }

    int OnesCount64(uint64_t x)
    {
        auto m = (1 << 64) - 1;
        x = (x >> 1) & (m0 & m) + x & (m0 & m);
        x = (x >> 2) & (m1 & m) + x & (m1 & m);
        x = ((x >> 4) + x) & (m2 & m);
        x += x >> 8;
        x += x >> 16;
        x += x >> 32;
        return int(x) & ((1 << 7) - 1);
    }

    unsigned int RotateLeft(unsigned int x, int k)
    {
        if(UintSize == 32)
        {
            return (unsigned int)(RotateLeft32(uint32_t(x), k));
        }
        return (unsigned int)(RotateLeft64(uint64_t(x), k));
    }

    uint8_t RotateLeft8(uint8_t x, int k)
    {
        auto n = 8;
        auto s = (unsigned int)(k) & (n - 1);
        return (x << s) | (x >> (n - s));
    }

    uint16_t RotateLeft16(uint16_t x, int k)
    {
        auto n = 16;
        auto s = (unsigned int)(k) & (n - 1);
        return (x << s) | (x >> (n - s));
    }

    uint32_t RotateLeft32(uint32_t x, int k)
    {
        auto n = 32;
        auto s = (unsigned int)(k) & (n - 1);
        return (x << s) | (x >> (n - s));
    }

    uint64_t RotateLeft64(uint64_t x, int k)
    {
        auto n = 64;
        auto s = (unsigned int)(k) & (n - 1);
        return (x << s) | (x >> (n - s));
    }

    unsigned int Reverse(unsigned int x)
    {
        if(UintSize == 32)
        {
            return (unsigned int)(Reverse32(uint32_t(x)));
        }
        return (unsigned int)(Reverse64(uint64_t(x)));
    }

    uint8_t Reverse8(uint8_t x)
    {
        return rev8tab[x];
    }

    uint16_t Reverse16(uint16_t x)
    {
        return uint16_t(rev8tab[x >> 8]) | (uint16_t(rev8tab[x & 0xff]) << 8);
    }

    uint32_t Reverse32(uint32_t x)
    {
        auto m = (1 << 32) - 1;
        x = (x >> 1) & (m0 & m) | (x & (m0 & m) << 1);
        x = (x >> 2) & (m1 & m) | (x & (m1 & m) << 2);
        x = (x >> 4) & (m2 & m) | (x & (m2 & m) << 4);
        return ReverseBytes32(x);
    }

    uint64_t Reverse64(uint64_t x)
    {
        auto m = (1 << 64) - 1;
        x = (x >> 1) & (m0 & m) | (x & (m0 & m) << 1);
        x = (x >> 2) & (m1 & m) | (x & (m1 & m) << 2);
        x = (x >> 4) & (m2 & m) | (x & (m2 & m) << 4);
        return ReverseBytes64(x);
    }

    unsigned int ReverseBytes(unsigned int x)
    {
        if(UintSize == 32)
        {
            return (unsigned int)(ReverseBytes32(uint32_t(x)));
        }
        return (unsigned int)(ReverseBytes64(uint64_t(x)));
    }

    uint16_t ReverseBytes16(uint16_t x)
    {
        return (x >> 8) | (x << 8);
    }

    uint32_t ReverseBytes32(uint32_t x)
    {
        auto m = (1 << 32) - 1;
        x = (x >> 8) & (m3 & m) | (x & (m3 & m) << 8);
        return (x >> 16) | (x << 16);
    }

    uint64_t ReverseBytes64(uint64_t x)
    {
        auto m = (1 << 64) - 1;
        x = (x >> 8) & (m3 & m) | (x & (m3 & m) << 8);
        x = (x >> 16) & (m4 & m) | (x & (m4 & m) << 16);
        return (x >> 32) | (x << 32);
    }

    int Len(unsigned int x)
    {
        if(UintSize == 32)
        {
            return Len32(uint32_t(x));
        }
        return Len64(uint64_t(x));
    }

    int Len8(uint8_t x)
    {
        return int(len8tab[x]);
    }

    int Len16(uint16_t x)
    {
        int n;
        if(x >= (1 << 8))
        {
            int n;
            x >>= 8;
            n = 8;
        }
        return n + int(len8tab[x]);
    }

    int Len32(uint32_t x)
    {
        int n;
        if(x >= (1 << 16))
        {
            int n;
            x >>= 16;
            n = 16;
        }
        if(x >= (1 << 8))
        {
            int n;
            x >>= 8;
            n += 8;
        }
        return n + int(len8tab[x]);
    }

    int Len64(uint64_t x)
    {
        int n;
        if(x >= (1 << 32))
        {
            int n;
            x >>= 32;
            n = 32;
        }
        if(x >= (1 << 16))
        {
            int n;
            x >>= 16;
            n += 16;
        }
        if(x >= (1 << 8))
        {
            int n;
            x >>= 8;
            n += 8;
        }
        return n + int(len8tab[x]);
    }

    std::tuple<unsigned int, unsigned int> Add(unsigned int x, unsigned int y, unsigned int carry)
    {
        unsigned int sum;
        unsigned int carryOut;
        if(UintSize == 32)
        {
            unsigned int sum;
            unsigned int carryOut;
            auto [s32, c32] = Add32(uint32_t(x), uint32_t(y), uint32_t(carry));
            return {(unsigned int)(s32), (unsigned int)(c32)};
        }
        auto [s64, c64] = Add64(uint64_t(x), uint64_t(y), uint64_t(carry));
        return {(unsigned int)(s64), (unsigned int)(c64)};
    }

    std::tuple<uint32_t, uint32_t> Add32(uint32_t x, uint32_t y, uint32_t carry)
    {
        uint32_t sum;
        uint32_t carryOut;
        auto sum64 = uint64_t(x) + uint64_t(y) + uint64_t(carry);
        sum = uint32_t(sum64);
        carryOut = uint32_t(sum64 >> 32);
        return {sum, carryOut};
    }

    std::tuple<uint64_t, uint64_t> Add64(uint64_t x, uint64_t y, uint64_t carry)
    {
        uint64_t sum;
        uint64_t carryOut;
        sum = x + y + carry;
        carryOut = ((x & y) | ((x | y) &^ sum)) >> 63;
        return {sum, carryOut};
    }

    std::tuple<unsigned int, unsigned int> Sub(unsigned int x, unsigned int y, unsigned int borrow)
    {
        unsigned int diff;
        unsigned int borrowOut;
        if(UintSize == 32)
        {
            unsigned int diff;
            unsigned int borrowOut;
            auto [d32, b32] = Sub32(uint32_t(x), uint32_t(y), uint32_t(borrow));
            return {(unsigned int)(d32), (unsigned int)(b32)};
        }
        auto [d64, b64] = Sub64(uint64_t(x), uint64_t(y), uint64_t(borrow));
        return {(unsigned int)(d64), (unsigned int)(b64)};
    }

    std::tuple<uint32_t, uint32_t> Sub32(uint32_t x, uint32_t y, uint32_t borrow)
    {
        uint32_t diff;
        uint32_t borrowOut;
        diff = x - y - borrow;
        borrowOut = ((~ x & y) | (~ (x ^ y) & diff)) >> 31;
        return {diff, borrowOut};
    }

    std::tuple<uint64_t, uint64_t> Sub64(uint64_t x, uint64_t y, uint64_t borrow)
    {
        uint64_t diff;
        uint64_t borrowOut;
        diff = x - y - borrow;
        borrowOut = ((~ x & y) | (~ (x ^ y) & diff)) >> 63;
        return {diff, borrowOut};
    }

    std::tuple<unsigned int, unsigned int> Mul(unsigned int x, unsigned int y)
    {
        unsigned int hi;
        unsigned int lo;
        if(UintSize == 32)
        {
            unsigned int hi;
            unsigned int lo;
            auto [h, l] = Mul32(uint32_t(x), uint32_t(y));
            return {(unsigned int)(h), (unsigned int)(l)};
        }
        auto [h, l] = Mul64(uint64_t(x), uint64_t(y));
        return {(unsigned int)(h), (unsigned int)(l)};
    }

    std::tuple<uint32_t, uint32_t> Mul32(uint32_t x, uint32_t y)
    {
        uint32_t hi;
        uint32_t lo;
        auto tmp = uint64_t(x) * uint64_t(y);
        std::tie(hi, lo) = std::tuple{uint32_t(tmp >> 32), uint32_t(tmp)};
        return {hi, lo};
    }

    std::tuple<uint64_t, uint64_t> Mul64(uint64_t x, uint64_t y)
    {
        uint64_t hi;
        uint64_t lo;
        auto mask32 = (1 << 32) - 1;
        auto x0 = x & mask32;
        auto x1 = x >> 32;
        auto y0 = y & mask32;
        auto y1 = y >> 32;
        auto w0 = x0 * y0;
        auto t = x1 * y0 + (w0 >> 32);
        auto w1 = t & mask32;
        auto w2 = t >> 32;
        w1 += x0 * y1;
        hi = x1 * y1 + w2 + (w1 >> 32);
        lo = x * y;
        return {hi, lo};
    }

    std::tuple<unsigned int, unsigned int> Div(unsigned int hi, unsigned int lo, unsigned int y)
    {
        unsigned int quo;
        unsigned int rem;
        if(UintSize == 32)
        {
            unsigned int quo;
            unsigned int rem;
            auto [q, r] = Div32(uint32_t(hi), uint32_t(lo), uint32_t(y));
            return {(unsigned int)(q), (unsigned int)(r)};
        }
        auto [q, r] = Div64(uint64_t(hi), uint64_t(lo), uint64_t(y));
        return {(unsigned int)(q), (unsigned int)(r)};
    }

    std::tuple<uint32_t, uint32_t> Div32(uint32_t hi, uint32_t lo, uint32_t y)
    {
        uint32_t quo;
        uint32_t rem;
        if(y != 0 && y <= hi)
        {
            uint32_t quo;
            uint32_t rem;
            gocpp::panic(overflowError);
        }
        auto z = (uint64_t(hi) << 32) | uint64_t(lo);
        std::tie(quo, rem) = std::tuple{uint32_t(z / uint64_t(y)), uint32_t(z % uint64_t(y))};
        return {quo, rem};
    }

    std::tuple<uint64_t, uint64_t> Div64(uint64_t hi, uint64_t lo, uint64_t y)
    {
        uint64_t quo;
        uint64_t rem;
        if(y == 0)
        {
            uint64_t quo;
            uint64_t rem;
            gocpp::panic(divideError);
        }
        if(y <= hi)
        {
            uint64_t quo;
            uint64_t rem;
            gocpp::panic(overflowError);
        }
        if(hi == 0)
        {
            uint64_t quo;
            uint64_t rem;
            return {lo / y, lo % y};
        }
        auto s = (unsigned int)(LeadingZeros64(y));
        y <<= s;
        auto two32 = 1 << 32;
        auto mask32 = two32 - 1;
        auto yn1 = y >> 32;
        auto yn0 = y & mask32;
        auto un32 = (hi << s) | (lo >> (64 - s));
        auto un10 = lo << s;
        auto un1 = un10 >> 32;
        auto un0 = un10 & mask32;
        auto q1 = un32 / yn1;
        auto rhat = un32 - q1 * yn1;
        for(; q1 >= two32 || q1 * yn0 > two32 * rhat + un1; )
        {
            uint64_t quo;
            uint64_t rem;
            q1--;
            rhat += yn1;
            if(rhat >= two32)
            {
                uint64_t quo;
                uint64_t rem;
                break;
            }
        }
        auto un21 = un32 * two32 + un1 - q1 * y;
        auto q0 = un21 / yn1;
        rhat = un21 - q0 * yn1;
        for(; q0 >= two32 || q0 * yn0 > two32 * rhat + un0; )
        {
            uint64_t quo;
            uint64_t rem;
            q0--;
            rhat += yn1;
            if(rhat >= two32)
            {
                uint64_t quo;
                uint64_t rem;
                break;
            }
        }
        return {q1 * two32 + q0, (un21 * two32 + un0 - q0 * y) >> s};
    }

    unsigned int Rem(unsigned int hi, unsigned int lo, unsigned int y)
    {
        if(UintSize == 32)
        {
            return (unsigned int)(Rem32(uint32_t(hi), uint32_t(lo), uint32_t(y)));
        }
        return (unsigned int)(Rem64(uint64_t(hi), uint64_t(lo), uint64_t(y)));
    }

    uint32_t Rem32(uint32_t hi, uint32_t lo, uint32_t y)
    {
        return uint32_t(((uint64_t(hi) << 32) | uint64_t(lo)) % uint64_t(y));
    }

    uint64_t Rem64(uint64_t hi, uint64_t lo, uint64_t y)
    {
        auto [gocpp_id_1, rem] = Div64(hi % y, lo, y);
        return rem;
    }

}

