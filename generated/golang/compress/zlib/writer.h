// generated by GoCpp from file '$(ImportDir)/compress/zlib/writer.go'
#pragma once

#include <functional>
#include <string>
#include <tuple>
#include <vector>

#include "golang/compress/zlib/writer.fwd.h"
#include "gocpp/support.h"

#include "golang/compress/flate/deflate.h"
#include "golang/compress/flate/deflatefast.h"
#include "golang/compress/flate/huffman_bit_writer.h"
#include "golang/compress/flate/huffman_code.h"
#include "golang/compress/flate/token.h"
#include "golang/hash/hash.h"
#include "golang/io/io.h"

namespace golang::zlib
{
    struct Writer
    {
        io::Writer w;
        int level;
        gocpp::slice<unsigned char> dict;
        flate::Writer* compressor;
        hash::Hash32 digest;
        std::string err;
        gocpp::array<unsigned char, 4> scratch;
        bool wroteHeader;

        using isGoStruct = void;

        template<typename T> requires gocpp::GoStruct<T>
        operator T();

        template<typename T> requires gocpp::GoStruct<T>
        bool operator==(const T& ref) const;

        std::ostream& PrintTo(std::ostream& os) const;
    };

    std::ostream& operator<<(std::ostream& os, const struct Writer& value);
    Writer* NewWriter(io::Writer w);
    std::tuple<Writer*, std::string> NewWriterLevel(io::Writer w, int level);
    std::tuple<Writer*, std::string> NewWriterLevelDict(io::Writer w, int level, gocpp::slice<unsigned char> dict);
    void Reset(struct Writer* z, io::Writer w);
    std::string writeHeader(struct Writer* z);
    std::tuple<int, std::string> Write(struct Writer* z, gocpp::slice<unsigned char> p);
    std::string Flush(struct Writer* z);
    std::string Close(struct Writer* z);
}

